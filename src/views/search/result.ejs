<% if (searchResult) { %>

<div class="container">
  <nav class="navbar navbar-default navbar-fixed-top"  style="margin-top:50px;z-index:10;">
    <div class="container-fluid">
      <%- partial('bucket') %>
    </div>
  </nav>
</div>

<div class="row">
  <% iterator = 0; %>
  <% if (searchResult.length) { %>
  <% searchResult.forEach(function (sRes) { %>


    <% var fare = sRes.Fares[0]; %>
<div class="row itinerary <%= fare.filterClass %>" style="padding-bottom:10px; border-top: 1px solid gray;background-color:#eee">
  <div class="col-xs-12">

    <div class="row">
      <div class="col-xs-12" style="padding: 2px;"><a href='/order' class="btn-success btn-sm">Buy<% var price = parseFloat(fare.BaseFare) + parseFloat(fare.Taxes); %>
        <% if(fare.CurrencyCode == 'USD') { %>
        $<%= price.toFixed(2) %> <% } else { %><%= price.toFixed(2) %> <%= fare.CurrencyCode %><% } %></a></div>
    </div>

    <% sRes.Citypairs.forEach(function (segment, i) { %>
      <% if (i == 0) { %><div class="row">
        <div class="col-sm-12"><strong><%= searchParams.DepartureLocationCode %>&rarr;<%= searchParams.ArrivalLocationCode %></strong></div>
      </div><% } else {%><br/><div class="row">
        <div class="col-sm-12"><strong><%= searchParams.ArrivalLocationCode %>&rarr;<%= searchParams.DepartureLocationCode %></strong></div>
      </div><% } %>
      <% segment.FlightSegment.forEach(function (fs) { %>
      <div class="row">
        <div class="col-xs-2"><%= fs.FlightNumber %></div>
        <div class="col-sm-1"><%= fs.DepartureLocationCode %>&rarr;<%= fs.ArrivalLocationCode %></div>
        <div class="col-xs-6"><%= fs.MarketingAirlineName %></div>
        <div class="col-sm-3"><span class="pull-right"><%= sails.moment(fs.DepartureDateTime).format('hh:mma') %> - <%= sails.moment(fs.ArrivalDateTime).format('hh:mma') %></span></div>
      </div>
      <div class="row">
        <div class="col-sm-3"><span class="small">Booking Class: <%= fs.BookingClass %></span></div>
        <div class="col-sm-3"><span class="small">Cabin Class: <%= fs.CabinClass %></span></div>
        <div class="col-sm-6"><span class="small pull-right">
          Flight time: <%= fs.Duration %>
          <% if (fs.NoOfStops > 0) { %>
          <span class="text-danger">+<%= fs.NoOfStops + __(' stops')%></span>
          <% } %></span>
        </div>
      </div>

    <% if (fs.merchandising) { %>
      <div class="row">
        <div class="col-xs-12">
          <button class="btn btn-xs btn-info btn-block mymorebutton" role="button" for="<%= iterator %>"><%= __('more')%></button>
        </div>
      </div>
      <div class="row hidden mymorecontent<%= iterator %>">
        <div class="panel panel-default">
          <div class="panel-heading">Merchandising Information</div>
          <div class="panel-body">
            <ul>
              <% fs.merchandising.forEach(function (item) { %>
              <li><%= item %></li>
              <% }) %>
            </ul>
          </div>
        </div>
      </div>
    <% } %>
      <% }); %>
    <% }); %>

  <% iterator++ %>
  </div>
</div>





  <% }) %>
  <% } %>
</div>

<style>
    body {
      padding-bottom: 70px;
      padding-top: 200px;
    }
</style>

<div class="container">
    <nav class="navbar navbar-default navbar-fixed-bottom">
      <div class="container-fluid">
        <a href='/order' class="btn btn-lg btn-primary btn-block" >Buy</a>
      </div>
    </nav>
</div>


<% } else { %>
    <div class="alert alert-danger" role="alert"><%= __('Can not find anything') %></div>
    <a href="/search"  class="btn btn-lg btn-primary btn-block" role="button"><%= __('Back to search') %></a>
<% } %>
